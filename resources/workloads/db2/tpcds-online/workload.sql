--main_phase_0
-- query 0
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 1
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 2
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 3
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 4
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 5
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 6
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 7
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 8
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 9
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 10
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 11
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 12
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 13
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 14
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 15
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 16
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 17
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 18
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 19
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 20
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 21
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 22
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 23
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 24
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 25
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 26
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 27
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 28
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 29
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 30
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 31
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 32
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 33
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 34
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 35
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 36
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 37
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 38
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 39
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 40
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 41
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 42
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 43
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 44
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 45
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 46
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 47
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 48
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 49
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 50
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 51
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 52
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 53
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 54
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 55
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 56
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 57
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 58
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 59
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 60
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 61
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 62
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 63
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 64
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 65
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 66
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 67
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 68
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 69
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 70
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 71
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 72
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 73
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 74
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 75
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 76
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 77
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 78
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 79
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 80
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 81
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 82
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 83
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 84
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 85
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 86
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 87
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 88
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 89
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 90
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 91
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 92
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 93
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 94
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 95
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 96
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 97
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 98
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 99
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 100
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 101
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 102
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 103
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 104
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 105
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 106
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 107
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 108
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 109
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 110
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 111
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 112
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 113
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 114
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 115
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 116
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 117
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 118
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 119
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 120
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 121
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 122
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 123
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 124
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 125
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 126
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 127
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 128
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 129
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 130
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 131
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 132
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 133
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 134
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 135
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 136
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 137
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 138
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 139
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 140
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 141
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 142
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 143
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 144
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 145
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 146
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 147
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 148
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 149
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 150
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 151
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 152
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 153
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 154
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 155
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 156
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 157
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 158
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 159
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 160
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 161
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 162
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 163
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 164
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 165
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 166
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 167
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 168
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 169
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 170
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 171
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 172
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 173
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 174
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 175
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 176
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 177
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 178
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 179
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 180
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 181
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 182
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 183
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 184
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 185
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 186
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 187
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 188
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 189
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 190
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 191
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 192
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 193
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 194
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 195
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 196
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 197
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 198
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 199
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
--main_phase_1
-- query 0
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 1
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 2
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 3
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 4
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 5
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 6
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 7
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 8
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 9
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 10
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 11
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 12
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 13
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 14
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 15
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 16
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 17
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 18
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 19
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 20
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 21
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 22
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 23
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 24
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 25
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 26
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 27
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 28
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 29
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 30
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 31
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 32
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 33
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 34
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 35
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 36
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 37
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 38
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 39
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 40
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 41
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 42
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 43
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 44
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 45
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 46
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 47
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 48
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 49
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 50
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 51
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 52
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 53
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 54
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 55
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 56
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 57
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 58
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 59
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 60
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 61
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 62
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 63
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 64
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 65
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 66
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 67
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 68
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 69
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 70
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 71
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 72
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 73
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 74
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 75
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 76
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 77
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 78
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 79
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 80
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 81
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 82
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 83
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 84
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 85
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 86
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 87
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 88
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 89
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 90
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 91
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 92
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 93
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 94
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 95
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 96
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 97
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 98
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 99
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 100
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 101
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 102
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 103
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 104
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 105
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 106
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 107
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 108
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 109
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 110
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 111
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 112
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 113
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 114
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 115
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 116
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 117
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 118
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 119
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 120
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 121
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 122
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 123
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 124
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 125
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 126
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 127
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 128
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 129
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 130
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 131
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 132
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 133
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 134
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 135
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 136
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 137
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 138
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 139
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 140
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 141
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 142
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 143
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 144
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 145
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 146
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 147
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 148
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 149
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 150
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 151
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 152
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 153
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 154
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 155
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 156
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 157
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 158
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 159
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 160
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 161
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 162
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 163
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 164
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 165
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 166
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 167
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 168
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 169
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 170
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 171
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 172
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 173
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 174
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 175
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 176
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 177
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 178
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 179
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 180
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 181
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 182
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 183
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 184
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 185
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 186
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 187
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 188
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 189
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 190
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 191
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 192
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 193
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 194
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 195
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 196
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 197
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 198
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 199
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
--main_phase_2
-- query 0
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 1
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 2
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 3
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 4
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 5
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 6
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 7
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 8
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 9
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 10
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 11
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 12
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 13
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 14
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 15
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 16
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 17
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 18
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 19
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 20
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 21
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 22
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 23
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 24
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 25
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 26
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 27
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 28
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 29
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 30
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 31
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 32
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 33
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 34
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 35
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 36
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 37
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 38
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 39
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 40
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 41
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 42
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 43
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 44
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 45
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 46
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 47
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 48
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 49
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 50
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 51
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 52
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 53
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 54
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 55
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 56
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 57
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 58
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 59
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 60
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 61
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 62
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 63
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 64
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 65
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 66
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 67
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 68
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 69
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 70
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 71
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 72
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 73
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 74
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 75
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 76
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 77
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 78
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 79
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 80
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 81
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 82
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 83
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 84
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 85
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 86
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 87
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 88
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 89
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 90
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 91
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 92
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 93
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 94
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 95
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 96
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 97
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 98
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 99
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 100
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 101
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 102
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 103
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 104
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 105
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 106
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
-- query 107
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 108
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 109
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 110
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 111
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 112
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 113
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 114
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 115
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 116
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 117
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 118
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 119
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 120
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 121
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 122
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 123
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 124
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 125
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 126
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 127
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 128
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 129
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 130
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 131
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 132
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 133
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 134
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 135
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 136
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 137
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 138
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 139
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 140
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 141
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 142
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 143
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 144
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 145
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 146
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 147
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 148
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 149
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 150
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 151
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 152
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 153
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 154
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 155
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 156
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 157
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 158
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 159
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 160
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 161
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 162
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 163
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 164
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 165
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 166
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 167
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 168
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 169
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 170
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 171
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 172
select * from (select i_manager_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and (( i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','refernece','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or( i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id, avg_monthly_sales, sum_sales fetch first 100 rows only ; 
-- query 173
select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', 'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id fetch first 100 rows only ; 
-- query 174
select substr(w_warehouse_name,1,20), sm_type, cc_name, sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.catalog_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.call_center, tpcds.date_dim where extract (year from d_date) = 1998 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20), sm_type, cc_name order by substr(w_warehouse_name,1,20), sm_type, cc_name fetch first 100 rows only ; 
-- query 175
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 176
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 177
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 178
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 179
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 180
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 181
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 182
select sum(cs_ext_discount_amt) as "excess discount amount" from tpcds.catalog_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from tpcds.catalog_sales, tpcds.date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-05' and (cast('2001-03-05' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) fetch first 100 rows only ; 
-- query 183
select * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from tpcds.item, tpcds.store_sales, tpcds.date_dim, tpcds.store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (1999) and ((i_category in ('Electronics','Sports','Shoes') and i_class in ('dvd/vcr players','guns','kids') ) or (i_category in ('Music','Women','Men') and i_class in ('pop','maternity','shirts') )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name fetch first 100 rows only ; 
-- query 184
with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_manufact_id in (select i_manufact_id from tpcds.item where i_category in ('Electronics')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales fetch first 100 rows only ; 
-- query 185
select dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category, sum(ss_ext_sales_price) from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year, tpcds.item.i_category_id, tpcds.item.i_category fetch first 100 rows only  ; 
-- query 186
select i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from tpcds.catalog_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'D' and cd_education_status = 'Primary' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 1998 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 187
select sum(ws_ext_discount_amt) as "Excess Discount Amount" from tpcds.web_sales, tpcds.item, tpcds.date_dim where i_manufact_id = 675 and i_item_sk = ws_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM tpcds.web_sales, tpcds.date_dim WHERE ws_item_sk = i_item_sk and d_date between '1998-01-30' and (cast('1998-01-30' as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) fetch first 100 rows only ; 
-- query 188
select i_item_id, i_item_desc, i_current_price from tpcds.item, tpcds.inventory, tpcds.date_dim, tpcds.store_sales where i_current_price between 31 and 31+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-05-18' as date) and (cast('2002-05-18' as date) + 60 days) and i_manufact_id in (867,107,602,451) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id fetch first 100 rows only ; 
-- query 189
select i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim, tpcds.store_sales, tpcds.item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=53 and d_moy=12 and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id fetch first 100 rows only  ; 
-- query 190
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 191
select ca_zip, sum(ws_sales_price) from tpcds.web_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim, tpcds.item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or i_item_id in (select i_item_id from tpcds.item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1999 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 192
select s_store_name, s_store_id, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.date_dim, tpcds.store_sales, tpcds.store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 1999 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales fetch first 100 rows only ; 
-- query 193
with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from tpcds.store_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from tpcds.web_sales, tpcds.date_dim, tpcds.customer_address, tpcds.item where i_item_id in (select i_item_id from tpcds.item where i_color in ('mint','orange','olive')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 7 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales fetch first 100 rows only ; 
-- query 194
select substr(w_warehouse_name,1,20), sm_type, web_name, sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days", sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as ">120 days" from tpcds.web_sales, tpcds.warehouse, tpcds.ship_mode, tpcds.web_site, tpcds.date_dim where extract(year from d_date) = 1998 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20), sm_type, web_name order by substr(w_warehouse_name,1,20), sm_type, web_name fetch first 100 rows only ; 
-- query 195
select ca_zip, sum(cs_sales_price) from tpcds.catalog_sales, tpcds.customer, tpcds.customer_address, tpcds.date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip order by ca_zip fetch first 100 rows only ; 
-- query 196
select c_customer_id as customer_id, c_last_name || ', ' || c_first_name as customername from tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics, tpcds.income_band, tpcds.store_returns where ca_city = 'Salem' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 38258 and ib_upper_bound <= 38258 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id fetch first 100 rows only ; 
-- query 197
select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from tpcds.call_center, tpcds.catalog_returns, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.customer_demographics, tpcds.household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Unknown') or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree')) and hd_buy_potential like '5001-10000%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc ; 
-- query 198
select dt.d_year, tpcds.item.i_brand_id brand_id, tpcds.item.i_brand brand, sum(ss_ext_sales_price) ext_price from tpcds.date_dim dt, tpcds.store_sales, tpcds.item where dt.d_date_sk = tpcds.store_sales.ss_sold_date_sk and tpcds.store_sales.ss_item_sk = tpcds.item.i_item_sk and tpcds.item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year, tpcds.item.i_brand, tpcds.item.i_brand_id order by dt.d_year, ext_price desc, brand_id fetch first 100 rows only  ; 
-- query 199
select * from(select w_warehouse_name, i_item_id, sum(case when (cast(d_date as date) < cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_before, sum(case when (cast(d_date as date) >= cast ('2002-05-09' as date)) then inv_quantity_on_hand else 0 end) as inv_after from tpcds.inventory, tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('2002-05-09' as date) - 30 days) and (cast ('2002-05-09' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name, i_item_id fetch first 100 rows only ; 
--main_phase_3
-- query 0
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 1
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 2
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 3
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 4
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 5
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 6
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 7
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 8
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 9
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 10
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 11
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 12
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 13
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 14
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 15
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 16
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 17
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 18
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 19
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 20
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 21
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 22
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 23
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 24
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 25
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 26
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 27
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 28
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 29
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 30
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 31
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 32
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 33
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 34
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 35
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 36
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 37
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 38
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 39
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 40
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 41
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 42
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 43
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 44
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 45
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 46
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 47
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 48
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 49
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 50
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 51
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 52
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 53
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 54
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 55
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 56
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 57
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 58
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 59
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 60
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 61
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 62
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 63
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 64
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 65
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 66
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 67
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 68
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 69
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 70
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 71
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 72
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 73
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 74
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 75
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 76
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 77
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 78
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 79
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 80
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 81
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 82
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 83
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 84
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 85
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 86
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 87
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 88
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 89
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 90
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 91
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 92
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 93
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 94
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 95
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 96
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 97
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 98
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 99
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 100
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 101
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 102
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 103
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 104
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 105
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 106
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 107
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 108
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 109
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 110
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 111
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 112
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 113
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 114
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 115
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 116
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 117
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 118
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 119
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 120
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 121
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 122
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 123
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 124
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 125
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 126
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 127
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 128
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 129
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 130
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 131
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 132
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 133
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 134
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 135
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 136
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 137
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 138
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 139
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 140
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 141
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 142
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 143
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 144
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 145
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 146
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 147
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 148
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 149
select s_store_name, sum(ss_net_profit) from tpcds.store_sales, tpcds.date_dim, tpcds.store, (select ca_zip from ( (SELECT substr(ca_zip,1,5) ca_zip FROM tpcds.customer_address WHERE substr(ca_zip,1,5) IN ( '28770','22406','84990','37601','12148','16006', '48732','14368','15447','12262','70483', '37463','15631','17727','10225','59176', '37668','65776','96083','90946','18674', '73506','13509','32137','33329','50534', '38862','42996','90592','99213','71363', '72890','33471','14265','61953','81674', '23523','13291','76248','13250','83607', '58749','27117','73867','88501','13213', '36285','16498','75897','85038','79615', '29044','46745','85381','97906','25235', '41927','13652','20504','22254','28616', '75431','98243','96508','43266','27218', '84385','30353','24834','93747','64144', '92994','27098','93158','56997','87436', '27931','27487','65275','55960','68863', '66290','29308','11111','89041','40351', '83542','96502','73055','76810','53337', '89572','37471','11257','90071','42520', '15877','75323','42374','36082','15023', '42900','70892','18404','46638','94480', '17423','31700','52142','54785','86220', '14887','50307','67866','49674','70436', '45055','84774','32385','72038','60421', '23462','11446','89945','98404','65478', '20749','11845','89409','59193','57687', '31236','33530','67003','89889','33164', '12292','60881','32203','71270','14911', '18844','18397','26767','39437','92108', '17246','53357','74612','53120','68632', '92018','14345','98111','65622','54706', '44130','10562','78330','69194','46593', '15627','14535','44655','78184','88106', '57470','98878','16415','64353','57172', '40824','12324','52012','74349','80323', '98734','70474','59159','51115','15003', '19908','18966','57066','55696','85300', '40581','39259','15304','54812','40369', '78396','58585','80079','68927','69080', '45340','30410','23271','23904','63204', '45908','54573','90070','68085','34418', '73265','70679','33661','45403','62985', '12823','33928','97817','63093','37708', '21009','40023','17744','45052','47249', '92933','59027','45762','23371','88295', '35445','77562','19072','18946','14501', '69144','10053','60091','10314','77319', '15961','19445','83317','64805','41996', '76825','13170','15264','83225','87248', '27749','39882','92688','81484','44811', '54208','55926','46237','55279','98696', '49830','60510','24261','90107','94192', '41609','77937','58737','28892','38216', '22861','92818','95022','59181','51971', '42538','20625','61787','43567','20148', '79376','20804','62246','49326','34819', '66972','15524','27116','57341','47760', '33953','37850','57830','18743','14182', '12789','18557','59696','96434','11101', '76340','12011','46097','27759','24084', '57428','30971','14719','82718','78582', '45030','91113','33945','71368','56369', '15129','96700','49947','11505','82544', '69959','75495','90786','49227','80358', '79028','27643','16330','47496','16775', '96139','39035','77772','93128','36485', '95729','10519','54218','43962','42289', '35895','34201','54832','30179','55376', '46077','87339','43883','30289','36111', '14359','89298','20746','64670','83780', '36901','11968','44193','87950','61889', '41788','35049','34862','10379','36987', '20434','26946','87414','29553','96117', '90604','33734','11414','16206','15583', '45042','48182','74138','10101','58855', '17133','79043','37181','36630','20262', '55210','62061','71395','32984','64643', '43620','92523','54314','98650','75682', '67356','59497','58949','62109','88703', '57638','92292','20159','38548')) intersect (select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM tpcds.customer_address, tpcds.customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1))A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2001 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name fetch first 100 rows only ; 
-- query 150
select s_store_name, i_item_desc, sc.revenue from tpcds.store, tpcds.item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from tpcds.store_sales, tpcds.date_dim where ss_sold_date_sk = d_date_sk and d_year = 1999 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc fetch first 100 rows only ; 
-- query 151
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 152
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 153
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 154
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 155
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 156
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 157
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 158
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 159
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 160
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 161
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 162
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 163
with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from tpcds.catalog_returns, tpcds.date_dim, tpcds.customer_address where cr_returned_date_sk = d_date_sk and d_year =1999 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk, ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CA' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name, ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset, ca_location_type,ctr_total_return fetch first 100 rows only ; 
-- query 164
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 165
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 166
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 167
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 168
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 169
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 170
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 171
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 172
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 173
select * from (select avg(ss_list_price) B1_LP, count(ss_list_price) B1_CNT, count(distinct ss_list_price) B1_CNTD from tpcds.store_sales where ss_quantity between 0 and 5 and (ss_list_price between 137 and 137+10 or ss_coupon_amt between 12463 and 12463+1000 or ss_wholesale_cost between 11 and 11+20)) B1, (select avg(ss_list_price) B2_LP, count(ss_list_price) B2_CNT, count(distinct ss_list_price) B2_CNTD from tpcds.store_sales where ss_quantity between 6 and 10 and (ss_list_price between 33 and 33+10 or ss_coupon_amt between 11715 and 11715+1000 or ss_wholesale_cost between 28 and 28+20)) B2, (select avg(ss_list_price) B3_LP, count(ss_list_price) B3_CNT, count(distinct ss_list_price) B3_CNTD from tpcds.store_sales where ss_quantity between 11 and 15 and (ss_list_price between 129 and 129+10 or ss_coupon_amt between 976 and 976+1000 or ss_wholesale_cost between 15 and 15+20)) B3, (select avg(ss_list_price) B4_LP, count(ss_list_price) B4_CNT, count(distinct ss_list_price) B4_CNTD from tpcds.store_sales where ss_quantity between 16 and 20 and (ss_list_price between 16 and 16+10 or ss_coupon_amt between 13211 and 13211+1000 or ss_wholesale_cost between 10 and 10+20)) B4, (select avg(ss_list_price) B5_LP, count(ss_list_price) B5_CNT, count(distinct ss_list_price) B5_CNTD from tpcds.store_sales where ss_quantity between 21 and 25 and (ss_list_price between 104 and 104+10 or ss_coupon_amt between 5947 and 5947+1000 or ss_wholesale_cost between 0 and 0+20)) B5, (select avg(ss_list_price) B6_LP, count(ss_list_price) B6_CNT, count(distinct ss_list_price) B6_CNTD from tpcds.store_sales where ss_quantity between 26 and 30 and (ss_list_price between 27 and 27+10 or ss_coupon_amt between 10996 and 10996+1000 or ss_wholesale_cost between 32 and 32+20)) B6 fetch first 100 rows only ; 
-- query 174
with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk, ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from tpcds.web_returns, tpcds.date_dim, tpcds.customer_address where wr_returned_date_sk = d_date_sk and d_year =1999 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk, ca_state) select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return from customer_total_return ctr1, tpcds.customer_address, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'CO' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag, c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address, c_last_review_date,ctr_total_return fetch first 100 rows only ; 
-- query 175
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 176
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 177
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 178
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 179
with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from tpcds.web_sales left join tpcds.web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join tpcds.date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from tpcds.catalog_sales left join tpcds.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join tpcds.date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from tpcds.store_sales left join tpcds.store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join tpcds.date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk) where coalesce(ws_qty,0)>0 and coalesce(cs_qty, 0)>0 and ss_sold_year=2001 order by ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, coalesce(ws_qty,0)+coalesce(cs_qty,0), coalesce(ws_wc,0)+coalesce(cs_wc,0), coalesce(ws_sp,0)+coalesce(cs_sp,0), round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2) fetch first 100 rows only ; 
-- query 180
with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from tpcds.store_sales,tpcds.date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1, sun_sales1/sun_sales2,mon_sales1/mon_sales2, tue_sales1/tue_sales1,wed_sales1/wed_sales2,thu_sales1/thu_sales2, fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1, s_store_id s_store_id1,sun_sales sun_sales1, mon_sales mon_sales1,tue_sales tue_sales1, wed_sales wed_sales1,thu_sales thu_sales1, fri_sales fri_sales1,sat_sales sat_sales1 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2, s_store_id s_store_id2,sun_sales sun_sales2, mon_sales mon_sales2,tue_sales tue_sales2, wed_sales wed_sales2,thu_sales thu_sales2, fri_sales fri_sales2,sat_sales sat_sales2 from wss,tpcds.store,tpcds.date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_year = 2000+1) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 fetch first 100 rows only ; 
-- query 181
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 182
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 183
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 184
with customer_total_return as (select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(sr_return_amt) as ctr_total_return from tpcds.store_returns, tpcds.date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk, sr_store_sk) select c_customer_id from customer_total_return ctr1, tpcds.store, tpcds.customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'AL' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id fetch first 100 rows only ; 
-- query 185
select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year, sum(jan_sales) as jan_sales, sum(feb_sales) as feb_sales, sum(mar_sales) as mar_sales, sum(apr_sales) as apr_sales, sum(may_sales) as may_sales, sum(jun_sales) as jun_sales, sum(jul_sales) as jul_sales, sum(aug_sales) as aug_sales, sum(sep_sales) as sep_sales, sum(oct_sales) as oct_sales, sum(nov_sales) as nov_sales, sum(dec_sales) as dec_sales, sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot, sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot, sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot, sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot, sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot, sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot, sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot, sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot, sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot, sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot, sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot, sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot, sum(jan_net) as jan_net, sum(feb_net) as feb_net, sum(mar_net) as mar_net, sum(apr_net) as apr_net, sum(may_net) as may_net, sum(jun_net) as jun_net, sum(jul_net) as jul_net, sum(aug_net) as aug_net, sum(sep_net) as sep_net, sum(oct_net) as oct_net, sum(nov_net) as nov_net, sum(dec_net) as dec_net from ( (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net, sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from tpcds.web_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 and 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) union all (select w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'LATVIAN' || ',' || 'DHL' as ship_carriers, d_year as year, sum(case when d_moy = 1 then cs_sales_price* cs_quantity else 0 end) as jan_sales, sum(case when d_moy = 2 then cs_sales_price* cs_quantity else 0 end) as feb_sales, sum(case when d_moy = 3 then cs_sales_price* cs_quantity else 0 end) as mar_sales, sum(case when d_moy = 4 then cs_sales_price* cs_quantity else 0 end) as apr_sales, sum(case when d_moy = 5 then cs_sales_price* cs_quantity else 0 end) as may_sales, sum(case when d_moy = 6 then cs_sales_price* cs_quantity else 0 end) as jun_sales, sum(case when d_moy = 7 then cs_sales_price* cs_quantity else 0 end) as jul_sales, sum(case when d_moy = 8 then cs_sales_price* cs_quantity else 0 end) as aug_sales, sum(case when d_moy = 9 then cs_sales_price* cs_quantity else 0 end) as sep_sales, sum(case when d_moy = 10 then cs_sales_price* cs_quantity else 0 end) as oct_sales, sum(case when d_moy = 11 then cs_sales_price* cs_quantity else 0 end) as nov_sales, sum(case when d_moy = 12 then cs_sales_price* cs_quantity else 0 end) as dec_sales, sum(case when d_moy = 1 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net, sum(case when d_moy = 2 then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net, sum(case when d_moy = 3 then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net, sum(case when d_moy = 4 then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net, sum(case when d_moy = 5 then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net, sum(case when d_moy = 6 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net, sum(case when d_moy = 7 then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net, sum(case when d_moy = 8 then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net, sum(case when d_moy = 9 then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net, sum(case when d_moy = 10 then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net, sum(case when d_moy = 11 then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net, sum(case when d_moy = 12 then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net from tpcds.catalog_sales, tpcds.warehouse, tpcds.date_dim, tpcds.time_dim, tpcds.ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 39920 AND 39920+28800 and sm_carrier in ('LATVIAN','DHL') group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year ) ) x group by w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year order by w_warehouse_name fetch first 100 rows only ; 
-- query 186
select count(*) from ((select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) except (select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1998) ) cool_cust  ; 
-- query 187
select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number, ss_customer_sk, tpcds.store.s_city, sum(ss_coupon_amt) amt, sum(ss_net_profit) profit from tpcds.store_sales,tpcds.date_dim,tpcds.store,tpcds.household_demographics where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and (tpcds.household_demographics.hd_dep_count = 1 or tpcds.household_demographics.hd_vehicle_count > 0) and tpcds.date_dim.d_dow = 1 and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,tpcds.store.s_city) ms,tpcds.customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit fetch first 100 rows only ; 
-- query 188
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 189
select 'web' as channel, web.item, web.return_ratio, web.return_rank, web.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item, (cast(sum(coalesce(wr.wr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(wr.wr_return_amt,0)) as dec(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.web_sales ws left outer join tpcds.web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk), tpcds.date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over ( order by currency_ratio) as currency_rank from (select cs.cs_item_sk as item, (cast(sum(coalesce(cr.cr_return_quantity,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(cr.cr_return_amount,0)) as dec(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.catalog_sales cs left outer join tpcds.catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk), tpcds.date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel, store.item, store.return_ratio, store.return_rank, store.currency_rank from ( select item, return_ratio, currency_ratio, rank() over (order by return_ratio) as return_rank, rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item, (cast(sum(coalesce(sr.sr_return_quantity,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as dec(15,4) )) as return_ratio, (cast(sum(coalesce(sr.sr_return_amt,0)) as dec(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as dec(15,4) )) as currency_ratio from tpcds.store_sales sts left outer join tpcds.store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk), tpcds.date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) order by 1,4,5 fetch first 100 rows only ; 
-- query 190
select c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price from (select ss_ticket_number, ss_customer_sk, ca_city bought_city, sum(ss_ext_sales_price) extended_price, sum(ss_ext_list_price) list_price, sum(ss_ext_tax) extended_tax from tpcds.store_sales, tpcds.date_dim, tpcds.store, tpcds.household_demographics, tpcds.customer_address where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_store_sk = tpcds.store.s_store_sk and tpcds.store_sales.ss_hdemo_sk = tpcds.household_demographics.hd_demo_sk and tpcds.store_sales.ss_addr_sk = tpcds.customer_address.ca_address_sk and tpcds.date_dim.d_dom between 1 and 2 and (tpcds.household_demographics.hd_dep_count = 7 or tpcds.household_demographics.hd_vehicle_count= 2) and tpcds.date_dim.d_year in (1999,1999+1,1999+2) and tpcds.store.s_city in ('Riverside','Midway') group by ss_ticket_number, ss_customer_sk, ss_addr_sk,ca_city) dn, tpcds.customer, tpcds.customer_address current_addr where ss_customer_sk = c_customer_sk and tpcds.customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name, ss_ticket_number fetch first 100 rows only ; 
-- query 191
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 
-- query 192
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 193
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 194
select ss_customer_sk, sum(act_sales) sumsales from (select ss_item_sk, ss_ticket_number, ss_customer_sk, case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from tpcds.store_sales left outer join tpcds.store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number), tpcds.reason where sr_reason_sk = r_reason_sk and r_reason_desc = 'reason 67') t group by ss_customer_sk order by sumsales, ss_customer_sk fetch first 100 rows only ; 
-- query 195
select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from tpcds.store_sales, tpcds.customer_demographics, tpcds.date_dim, tpcds.item, tpcds.promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'M' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id fetch first 100 rows only ; 
-- query 196
select count(*) from ( select distinct c_last_name, c_first_name, d_date from tpcds.store_sales, tpcds.date_dim, tpcds.customer where tpcds.store_sales.ss_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.store_sales.ss_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.catalog_sales, tpcds.date_dim, tpcds.customer where tpcds.catalog_sales.cs_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.catalog_sales.cs_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 intersect select distinct c_last_name, c_first_name, d_date from tpcds.web_sales, tpcds.date_dim, tpcds.customer where tpcds.web_sales.ws_sold_date_sk = tpcds.date_dim.d_date_sk and tpcds.web_sales.ws_bill_customer_sk = tpcds.customer.c_customer_sk and d_year = 1999 ) hot_cust fetch first 100 rows only ; 
-- query 197
select w_state, i_item_id, sum(case when (cast(d_date as date) < cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before, sum(case when (cast(d_date as date) >= cast ('2001-05-21' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from tpcds.catalog_sales left outer join tpcds.catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk), tpcds.warehouse, tpcds.item, tpcds.date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-21' as date) - 30 days) and (cast ('2001-05-21' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id fetch first 100 rows only ; 
-- query 198
select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from tpcds.store_sales, tpcds.store, tpcds.promotion, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y') and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) promotional_sales, (select sum(ss_ext_sales_price) total from tpcds.store_sales, tpcds.store, tpcds.date_dim, tpcds.customer, tpcds.customer_address, tpcds.item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = 'Books' and s_gmt_offset = -6 and d_year = 1999 and d_moy = 12) all_sales order by promotions, total fetch first 100 rows only ; 
-- query 199
select case when (select count(*) from tpcds.store_sales where ss_quantity between 1 and 20) > 0.001*219075 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from tpcds.store_sales where ss_quantity between 21 and 40) > 0.001*55037 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from tpcds.store_sales where ss_quantity between 41 and 60) > 0.001*28293 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from tpcds.store_sales where ss_quantity between 61 and 80) > 0.001*104204 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from tpcds.store_sales where ss_quantity between 81 and 100) > 0.001*141976 then (select avg(ss_ext_list_price) from tpcds.store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from tpcds.store_sales where ss_quantity between 81 and 100) end bucket5 from tpcds.reason where r_reason_sk = 1 fetch first 100 rows only ; 

